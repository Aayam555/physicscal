<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPhO 1967 Problem 1 Solution & Simulation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        #simulationCanvas {
            background-color: #e2e8f0;
            border-radius: 8px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
            width: 100%;
            height: auto;
        }
        .info-card {
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .button {
            transition: all 0.2s;
        }
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .button:active {
            transform: translateY(0);
            box-shadow: none;
        }
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: #e5e7eb;
        }
        @media (min-width: 768px) {
            #simulation-container {
                display: flex;
                align-items: flex-start;
                justify-content: space-between;
                flex-direction: row;
            }
            .canvas-container {
                width: 65%;
            }
            .info-panel {
                width: 30%;
            }
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col items-center justify-center min-h-screen p-4">

    <div class="max-w-4xl mx-auto space-y-8 bg-white p-8 rounded-lg shadow-xl">
        
        <!-- Problem Statement Section -->
        <div class="problem-statement">
            <h1 class="text-3xl font-bold mb-4 text-gray-800 section-title relative">Problem 1</h1>
            <div class="text-gray-700 leading-relaxed mb-6">
                <p>A small ball with mass $M = 0.2 \text{ kg}$ rests on a vertical column with height $h = 5 \text{ m}$. A bullet with mass $m = 0.01 \text{ kg}$, moving with velocity $v_0 = 500 \text{ m/s}$, passes horizontally through the center of the ball. The ball reaches the ground at a distance $s = 20 \text{ m}$. Where does the bullet reach the ground? What part of the kinetic energy of the bullet was converted into heat when the bullet passed through the ball? Neglect resistance of the air. Assume that $g = 10 \text{ m/s}^2$. </p>
            </div>
            <div class="flex justify-center">
                <img src="../images/1967-1.png" alt="Diagram showing the setup of the physics problem with a ball on a column and a bullet passing through it.">
            </div>
        </div>
        
        <!-- Solution Section -->
        <div class="solution-section">
            <h2 class="text-2xl font-bold mb-4 text-gray-800 section-title relative">Solution</h2>
            <div class="mb-6 space-y-4">
                <h3 class="text-xl font-semibold text-gray-700">Part 1: Horizontal Distance of Bullet</h3>
                <p class="text-gray-700">First, we determine the time of flight for both the ball and the bullet. The time taken to fall from height $h$ is given by:</p>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <p>$$t = \sqrt{\frac{2h}{g}} = \sqrt{\frac{2 \times 5}{10}} = 1 \text{ s}$$</p>
                </div>
                <p class="text-gray-700">Using conservation of momentum, we find the final velocity of the bullet:</p>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <p>$$m v_0 = m v + M V$$</p>
                    <p>where $V = \frac{s}{t} = \frac{20 \text{ m}}{1 \text{ s}} = 20 \text{ m/s}$.</p>
                    <p>Solving for $v$ (bullet's final velocity):</p>
                    <p>$$v = \frac{m v_0 - M V}{m} = \frac{(0.01)(500) - (0.2)(20)}{0.01} = 100 \text{ m/s}$$</p>
                </div>
                <p class="text-gray-700">The horizontal distance traveled by the bullet is:</p>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <p>$$d = v \times t = (100 \text{ m/s})(1 \text{ s}) = 100 \text{ m}$$</p>
                    <p class="font-bold text-gray-800 mt-2">The bullet reaches the ground at a distance of $100 \text{ m}$.</p>
                </div>
            </div>
            <div class="mb-6 space-y-4">
                <h3 class="text-xl font-semibold text-gray-700">Part 2: Energy Converted to Heat</h3>
                <p class="text-gray-700">The energy converted to heat is the difference between the initial kinetic energy of the bullet and the final total kinetic energy of the system.</p>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <p>$$E_0 = \frac{1}{2}mv_0^2 = \frac{1}{2}(0.01)(500)^2 = 1250 \text{ J}$$</p>
                    <p>$$E_f = \frac{1}{2}mv^2 + \frac{1}{2}MV^2 = \frac{1}{2}(0.01)(100)^2 + \frac{1}{2}(0.2)(20)^2 = 90 \text{ J}$$</p>
                    <p>$$\Delta E = E_0 - E_f = 1250 - 90 = 1160 \text{ J}$$</p>
                </div>
                <p class="text-gray-700">The part of the initial kinetic energy converted to heat is:</p>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <p>$$p = \frac{\Delta E}{E_0} = \frac{1160}{1250} = 0.928$$</p>
                    <p class="font-bold text-gray-800 mt-2">This is equal to 92.8%.</p>
                </div>
            </div>
        </div>

        <div class="w-full h-px bg-gray-300 my-8"></div>

        <!-- Simulation Section -->
        <div class="simulation-section">
            <h2 class="text-2xl font-bold mb-4 text-gray-800 section-title relative">Interactive Simulation</h2>
            <div id="simulation-container" class="flex flex-col md:flex-row items-start space-y-8 md:space-y-0 md:space-x-8 w-full">
                <!-- Canvas and Controls -->
                <div class="w-full md:w-2/3 flex flex-col items-center canvas-container">
                    <canvas id="simulationCanvas" width="800" height="400" class="rounded-lg shadow-lg mb-4"></canvas>
                    <div class="flex space-x-4">
                        <button id="startButton" class="button bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full shadow-lg">Start Simulation</button>
                        <button id="resetButton" class="button bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-6 rounded-full shadow-lg">Reset</button>
                    </div>
                </div>

                <!-- Solution & Info Panel -->
                <div class="w-full md:w-1/3 info-card p-6 rounded-lg space-y-6 info-panel">
                    <div class="border-b pb-4 mb-4">
                        <h3 class="text-xl font-bold text-gray-800 section-title relative">Parameters</h3>
                        <ul class="text-sm mt-2 text-gray-700 space-y-1">
                            <li>Bullet Mass ($m$): 0.01 kg</li>
                            <li>Ball Mass ($M$): 0.2 kg</li>
                            <li>Bullet Initial Velocity ($v_0$): 500 m/s</li>
                            <li>Column Height ($h$): 5 m</li>
                            <li>Ball Landing Distance ($s$): 20 m</li>
                            <li>Gravity ($g$): 10 m/s²</li>
                        </ul>
                    </div>

                    <div class="border-b pb-4 mb-4">
                        <h3 class="text-xl font-bold text-gray-800 section-title relative">Calculations</h3>
                        <div id="calculations" class="text-sm mt-2 text-gray-700 space-y-1">
                            <!-- Values will be populated by JS -->
                        </div>
                    </div>

                    <div>
                        <h3 class="text-xl font-bold text-gray-800 section-title relative">Results</h3>
                        <div id="results" class="text-sm mt-2 text-gray-700 space-y-1">
                            <!-- Results will be populated by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const canvas = document.getElementById('simulationCanvas');
            const ctx = canvas.getContext('2d');
            const startButton = document.getElementById('startButton');
            const resetButton = document.getElementById('resetButton');
            const calculationsEl = document.getElementById('calculations');
            const resultsEl = document.getElementById('results');

            // --- Problem Constants (from the provided solution) ---
            const g = 10; // m/s²
            const h = 5; // m
            const m = 0.01; // kg (bullet mass)
            const M = 0.2; // kg (ball mass)
            const v0 = 500; // m/s (initial bullet velocity)
            const s = 20; // m (ball landing distance)
            const columnHeight = h;

            // --- Simulation Variables ---
            let animationFrameId;
            let lastTime = 0;
            let isSimulationRunning = false;
            let timeElapsed = 0;
            let bulletState = 'initial'; // 'initial', 'afterCollision', 'done'
            let collisionTime = 0;

            // Fix: Define the ball and bullet objects in the correct scope.
            let ball = {
                x: 0,
                y: 0,
                radius: 10,
                color: '#4299e1',
            };
            let bullet = {
                x: 0,
                y: 0,
                radius: 3,
                color: '#f56565',
            };

            // --- Calculated Values ---
            let timeOfFlight, vBall, vBulletFinal, dBullet;
            let initialKE, finalKE, energyLoss, energyLossRatio;

            // --- Setup and Calculations ---
            const calculateSolution = () => {
                // Time of flight
                timeOfFlight = Math.sqrt((2 * h) / g);
                
                // Ball's final horizontal velocity
                vBall = s / timeOfFlight;

                // Bullet's final horizontal velocity (from momentum conservation)
                vBulletFinal = (m * v0 - M * vBall) / m;
                
                // Bullet's landing distance
                dBullet = vBulletFinal * timeOfFlight;

                // Energy calculations
                initialKE = 0.5 * m * v0 * v0;
                finalKE = 0.5 * m * vBulletFinal * vBulletFinal + 0.5 * M * vBall * vBall;
                energyLoss = initialKE - finalKE;
                energyLossRatio = energyLoss / initialKE;

                updateInfoPanel();
            };

            const updateInfoPanel = () => {
                calculationsEl.innerHTML = `
                    <p>Time of flight: <strong>${timeOfFlight.toFixed(2)} s</strong></p>
                    <p>Ball's final velocity: <strong>${vBall.toFixed(2)} m/s</strong></p>
                    <p>Bullet's final velocity: <strong>${vBulletFinal.toFixed(2)} m/s</strong></p>
                    <p>Bullet's Initial KE: <strong>${initialKE.toFixed(2)} J</strong></p>
                    <p>Final Total KE: <strong>${finalKE.toFixed(2)} J</strong></p>
                `;

                resultsEl.innerHTML = `
                    <p>Bullet Landing Distance: <strong>${dBullet.toFixed(2)} m</strong></p>
                    <p>Energy Converted to Heat: <strong>${energyLoss.toFixed(2)}J</strong></p>
                    <p>Fraction of KE Lost: <strong>${(energyLossRatio * 100).toFixed(1)}%</strong></p>
                `;
            };

            const draw = () => {
                // Scaling for a nice visual representation
                const scaleX = canvas.width / (dBullet * 1.2);
                const scaleY = canvas.height / (h * 1.5);
                const baseLineY = canvas.height - 20;

                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Draw ground
                ctx.beginPath();
                ctx.moveTo(0, baseLineY);
                ctx.lineTo(canvas.width, baseLineY);
                ctx.strokeStyle = '#4b5563';
                ctx.lineWidth = 2;
                ctx.stroke();

                // Draw labels for the ground and column
                ctx.font = '12px Inter';
                ctx.fillStyle = '#4b5563';
                ctx.textAlign = 'center';
                ctx.fillText('Ground Level', canvas.width / 2, baseLineY + 15);
                
                // Draw column
                ctx.fillStyle = '#4b5563';
                const columnX = 10 * scaleX;
                const columnY = baseLineY - (columnHeight * scaleY);
                ctx.fillRect(columnX, columnY, 5, columnHeight * scaleY);
                
                // Label for the column
                ctx.save();
                ctx.translate(columnX - 15, columnY + (columnHeight * scaleY) / 2);
                ctx.rotate(-Math.PI / 2);
                ctx.fillText('Column', 0, 0);
                ctx.restore();

                // Draw height line
                ctx.beginPath();
                ctx.setLineDash([5, 5]);
                ctx.moveTo(columnX + 2.5, columnY);
                ctx.lineTo(columnX + 2.5, baseLineY);
                ctx.strokeStyle = '#6b7280';
                ctx.stroke();
                ctx.setLineDash([]);
                
                // Height label
                ctx.textAlign = 'left';
                ctx.fillText(`h = ${h} m`, columnX + 10, columnY + (columnHeight * scaleY) / 2);


                // Draw ball
                ctx.beginPath();
                ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
                ctx.fillStyle = ball.color;
                ctx.fill();

                // Label the ball
                ctx.fillStyle = ball.color;
                ctx.textAlign = 'center';
                ctx.fillText('Ball', ball.x, ball.y - ball.radius - 5);
                
                // Draw bullet
                ctx.beginPath();
                ctx.arc(bullet.x, bullet.y, bullet.radius, 0, Math.PI * 2);
                ctx.fillStyle = bullet.color;
                ctx.fill();

                // Label the bullet
                ctx.fillStyle = bullet.color;
                ctx.textAlign = 'center';
                ctx.fillText('Bullet', bullet.x, bullet.y - bullet.radius - 5);


                // Draw distance labels
                ctx.fillStyle = '#4b5563';
                ctx.textAlign = 'center';

                if (bulletState !== 'initial') {
                    // Ball distance
                    ctx.beginPath();
                    ctx.moveTo(columnX + 2.5, baseLineY + 30);
                    ctx.lineTo(columnX + s * scaleX, baseLineY + 30);
                    ctx.strokeStyle = '#60a5fa';
                    ctx.lineWidth = 1;
                    ctx.stroke();
                    ctx.fillText(`s = ${s} m`, columnX + (s * scaleX) / 2, baseLineY + 45);

                    // Bullet distance
                    ctx.beginPath();
                    ctx.moveTo(columnX + 2.5, baseLineY + 60);
                    ctx.lineTo(columnX + dBullet * scaleX, baseLineY + 60);
                    ctx.strokeStyle = '#f87171';
                    ctx.lineWidth = 1;
                    ctx.stroke();
                    ctx.fillText(`d = ${dBullet.toFixed(2)} m`, columnX + (dBullet * scaleX) / 2, baseLineY + 75);
                }
            };

            const update = (time) => {
                if (!isSimulationRunning) return;

                const deltaTime = (time - lastTime) / 1000;
                lastTime = time;
                timeElapsed += deltaTime;
                
                const scaleX = canvas.width / (dBullet * 1.2);
                const scaleY = canvas.height / (h * 1.5);
                const baseLineY = canvas.height - 20;
                const initialBallX = 10 * scaleX;
                const initialBallY = baseLineY - (columnHeight * scaleY);

                if (bulletState === 'initial') {
                    // Bullet approaching the ball
                    bullet.x = timeElapsed * v0 * scaleX;
                    bullet.y = initialBallY;
                    
                    if (bullet.x >= initialBallX) {
                        // Collision point
                        bulletState = 'afterCollision';
                        collisionTime = timeElapsed;
                        
                        // Set initial positions for post-collision motion
                        ball.x = initialBallX;
                        ball.y = initialBallY;
                        bullet.x = initialBallX;
                        bullet.y = initialBallY;
                    }
                }

                if (bulletState === 'afterCollision') {
                    const postCollisionTime = timeElapsed - collisionTime;

                    // Update positions using projectile motion
                    ball.x = initialBallX + (vBall * postCollisionTime * scaleX);
                    ball.y = initialBallY + (0.5 * g * postCollisionTime * postCollisionTime * scaleY);

                    bullet.x = initialBallX + (vBulletFinal * postCollisionTime * scaleX);
                    bullet.y = initialBallY + (0.5 * g * postCollisionTime * postCollisionTime * scaleY);

                    // Check for landing
                    if (ball.y >= baseLineY - ball.radius || bullet.y >= baseLineY - bullet.radius) {
                        isSimulationRunning = false;
                        bulletState = 'done';
                        draw(); // Final draw to show objects at ground level
                        return;
                    }
                }

                draw();
                animationFrameId = requestAnimationFrame(update);
            };

            const startSimulation = () => {
                if (isSimulationRunning) return;
                isSimulationRunning = true;
                lastTime = performance.now();
                animationFrameId = requestAnimationFrame(update);
                startButton.disabled = true;
            };

            const resetSimulation = () => {
                cancelAnimationFrame(animationFrameId);
                isSimulationRunning = false;
                timeElapsed = 0;
                bulletState = 'initial';
                
                // Reset positions
                const scaleX = canvas.width / (dBullet * 1.2);
                const scaleY = canvas.height / (h * 1.5);
                const baseLineY = canvas.height - 20;
                const initialY = baseLineY - (columnHeight * scaleY);

                // Fix: Access properties of the already-defined objects.
                bullet.x = -bullet.radius * 2; // Start off-screen
                bullet.y = initialY;
                ball.x = 10 * scaleX;
                ball.y = initialY;
                
                startButton.disabled = false;
                draw();
            };

            startButton.addEventListener('click', startSimulation);
            resetButton.addEventListener('click', resetSimulation);

            // Initial setup
            calculateSolution();
            resetSimulation();
        });
    </script>
</body>
</html>
